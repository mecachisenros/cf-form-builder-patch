!function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=22)}([function(e,n){!function(){e.exports=this.React}()},function(e,n){!function(){e.exports=this.wp.element}()},function(e,n,t){e.exports=t(19)()},function(e,n){!function(){e.exports=this.wp.components}()},function(e,n,t){var o=t(12),r=t(13),i=t(14),a=t(16);e.exports=function(e,n){return o(e)||r(e,n)||i(e,n)||a()}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ErrorBoundaryFallbackComponent=n.withErrorBoundary=n.ErrorBoundary=void 0;var o=a(t(6)),r=t(21),i=a(r);function a(e){return e&&e.__esModule?e:{default:e}}n.default=i.default,n.ErrorBoundary=i.default,n.withErrorBoundary=r.withErrorBoundary,n.ErrorBoundaryFallbackComponent=o.default},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o,r=t(0),i=(o=r)&&o.__esModule?o:{default:o};var a=function(e,n){return e.toString()+"\n\nThis is located at:"+n},c=function(e){var n=e.componentStack,t=e.error;return i.default.createElement("div",{style:l,title:a(t,n)},i.default.createElement("svg",{style:u,viewBox:"0 0 24 24",preserveAspectRatio:"xMidYMid"},i.default.createElement("path",{d:"M20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,\n        12M22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2A10,10 0 0,1 22,\n        12M15.5,8C16.3,8 17,8.7 17,9.5C17,10.3 16.3,11 15.5,11C14.7,11 14,10.3 14,\n        9.5C14,8.7 14.7,8 15.5,8M10,9.5C10,10.3 9.3,11 8.5,11C7.7,11 7,10.3 7,9.5C7,\n        8.7 7.7,8 8.5,8C9.3,8 10,8.7 10,9.5M12,14C13.75,14 15.29,14.72 16.19,\n        15.81L14.77,17.23C14.32,16.5 13.25,16 12,16C10.75,16 9.68,16.5 9.23,\n        17.23L7.81,15.81C8.71,14.72 10.25,14 12,14Z"})))};c.propTypes={componentStack:t(2).string.isRequired,error:"function"==typeof Error?t(2).instanceOf(Error).isRequired:t(2).any.isRequired};var l={height:"100%",maxHeight:"100vh",width:"100%",maxWidth:"100vw",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",backgroundColor:"#C00",color:"#FFF",boxSizing:"border-box",cursor:"help"},u={fill:"currentColor",flex:"1 1 auto"};n.default=c},function(e,n){e.exports=function(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}},function(e,n){!function(){e.exports=this.wp.domReady}()},function(e,n){!function(){e.exports=this.wp.apiFetch}()},function(e,n,t){e.exports=t(18).default},function(e,n){!function(){e.exports=this.ReactDOM}()},function(e,n){e.exports=function(e){if(Array.isArray(e))return e}},function(e,n){e.exports=function(e,n){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var t=[],o=!0,r=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(o=(a=c.next()).done)&&(t.push(a.value),!n||t.length!==n);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==c.return||c.return()}finally{if(r)throw i}}return t}}},function(e,n,t){var o=t(15);e.exports=function(e,n){if(e){if("string"==typeof e)return o(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?o(e,n):void 0}}},function(e,n){e.exports=function(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}},function(e,n){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,n,t){},function(e,n,t){"use strict";function o(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=t.get(e);if(r)return r;if(Array.isArray(e)){var i=[];t.set(e,i);for(var a=0;a<e.length;a++)i[a]=o(e[a],n,t);return i}if(e instanceof Date)return new Date(e.valueOf());if(!(e instanceof Object))return e;var c={};t.set(e,c);for(var l=Object.keys(e),u=0;u<l.length;u++){var s=n?n(l[u]):l[u];c[s]=o(e[l[u]],n,t)}return c}function r(e){return function(n){return o(n,e)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=o,n.formatKeys=r,o.formatKeys=r},function(e,n,t){"use strict";var o=t(20);function r(){}function i(){}i.resetWarningCache=r,e.exports=function(){function e(e,n,t,r,i,a){if(a!==o){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}function n(){return e}e.isRequired=e;var t={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:n,element:e,elementType:e,instanceOf:n,node:e,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:i,resetWarningCache:r};return t.PropTypes=t,t}},function(e,n,t){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.withErrorBoundary=void 0;var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}(),r=t(0),i=c(r),a=c(t(6));function c(e){return e&&e.__esModule?e:{default:e}}function l(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function u(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}var s=t(0).babelPluginFlowReactPropTypes_proptype_ComponentType||t(2).any,d=function(e){function n(){var e,t,o;l(this,n);for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=o=u(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(i))),o.state={error:null,info:null},u(o,t)}return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}(n,e),o(n,[{key:"componentDidCatch",value:function(e,n){var t=this.props.onError;if("function"==typeof t)try{t.call(this,e,n?n.componentStack:"")}catch(e){}this.setState({error:e,info:n})}},{key:"render",value:function(){var e=this.props,n=e.children,t=e.FallbackComponent,o=this.state,r=o.error,a=o.info;return null!==r?i.default.createElement(t,{componentStack:a?a.componentStack:"",error:r}):n||null}}]),n}(r.Component);d.defaultProps={FallbackComponent:a.default},d.propTypes={error:"function"==typeof Error?t(2).instanceOf(Error):t(2).any,info:t(2).shape({componentStack:t(2).string.isRequired})},(n.withErrorBoundary=function(e,n,t){var o=function(o){return i.default.createElement(d,{FallbackComponent:n,onError:t},i.default.createElement(e,o))},r=e.displayName||e.name;return o.displayName=r?"WithErrorBoundary("+r+")":"WithErrorBoundary",o}).propTypes=s===t(2).any?{}:s,n.default=d},function(e,n,t){"use strict";t.r(n);var o=t(7),r=t.n(o),i=t(4),a=t.n(i),c=t(1),l=t(3),u=t(0),s=t.n(u),d=t(8),f=t.n(d),p=t(9),m=t.n(p),g=(t(17),t(10)),v=t.n(g),y=t(11),h=t.n(y),E=t(5),b=t.n(E);function O(){return(O=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}var C=function(e){return s.a.createElement("select",{required:e.required,value:e.value,name:e.name,id:e.id,className:e.className,onChange:function(n){return e.onChange?e.onChange(n.target.value):null}},e.options&&e.options.length?e.options.map((function(e){return s.a.createElement("option",{key:e.value,value:e.value},e.label)})):s.a.createElement("option",null))};function I(e){var n=e.label,t=e.value,o=e.onChange,r=e.settingName,i=e.description,a=e.required,c=e.options,l=e.isStandard,u=e.id,d=e.className;return s.a.createElement("div",{className:l?"caldera-config-group":""},s.a.createElement("label",{htmlFor:u},n),s.a.createElement("div",{className:"caldera-config-field"},s.a.createElement(C,{required:a,value:t,name:r,id:u,options:c,className:d||"block-input "+(e.isStandard?"field-config":""),onChange:o}),i&&s.a.createElement("p",{className:"description"},i)))}function F(e){var n=function(n){return e.filter((function(e){return n.includes(e.type)}))};return{formFields:e,getFieldMagicTags:function(){var n=[];return e.forEach((function(e){return n.push({tag:e.slug,type:e.type,before:"%",after:"%"})})),n},getByFieldType:function(n){return e.filter((function(e){return n===e.type}))},getByFieldTypes:n,getFieldByLabel:function(n){return e.find((function(e){return n===e.label}))},getFieldById:function(n){return e.find((function(e){return n===e.ID}))},getAllowedFieldsAsOptions:function(e){var t=n(e);return t&&t.length?t.map((function(e){return{value:e.ID,id:e.ID,label:e.label}})):[]}}}var w=function(e,n){var t=function(e){var n=[];return e&&Object.keys(e).forEach((function(t){var o=e[t];o.conditions&&o.conditions.hasOwnProperty("type")&&o.conditions.type&&n.push({fieldId:o.ID,conditionalId:o.conditions.type})})),n}(n);return Object.values(e).map((function(e){return function(e,n){var t=e.id,o=e.type?e.type:"show",r=e.hasOwnProperty("name")&&e.name?e.name:"",i=n?n.filter((function(e){return t===e.conditionalId})).map((function(e){return e.fieldId})):[];if(!r)return{id:t,type:o};var a=N(e.group?e.group:{});return{id:t,type:o,config:{name:r,appliesTo:i,fields:e.fields?e.fields:{},group:e.group?e.group:{},groups:a}}}(e,t)}))},P=function(e){var n={};return e.forEach((function(e){return n[e.id]=function(e){var n,t,o={id:e.id,type:e.type},r=e.config?e.config:void 0;if(!r)return o;var i={};null===(n=e.config)||void 0===n||null===(t=n.groups)||void 0===t||t.forEach((function(e){e.lines.forEach((function(e){i[e.id]=e.field}))}));var a=r.group?r.group:void 0;return O({},o,{name:r.name,fields:i,group:a||{}})}(e)})),n},N=function(e){var n=[];return e&&Object.keys(e).forEach((function(t){var o=[];e&&e.hasOwnProperty(t)&&Object.keys(e[t]).forEach((function(n){e.hasOwnProperty(t)&&e[t].hasOwnProperty(n)&&o.push(O({},e[t][n],{id:n}))})),n.push({id:t,lines:o})})),n},k=function(e){var n=e.text,t=e.onClick;return s.a.createElement("button",{style:{width:"250px"},id:"new-conditional",className:"button",type:"button",onClick:function(e){e.preventDefault(),t()}},n)},x=function(e){var n=e.strings,t=e.onNewConditional,o=s.a.useState(""),r=o[0],i=o[1],a=s.a.useState(""),c=a[0],l=a[1],d=s.a.useState(!1),f=d[0],p=d[1],m=s.a.useRef(null),g=function(e,n){t(e,n),i(""),p(!1)},v=function(){if(f)r.length&&g(r,c);else if(m.current){var e="con_"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5);l(e),p(!0)}};return s.a.useEffect((function(){f&&m.current&&m.current.focus()}),[f]),s.a.createElement(u.Fragment,null,s.a.createElement(k,{text:n["new-conditional"],onClick:v}),s.a.createElement("input",{ref:function(e){m.current=e},type:"text",name:"conditions["+c+"][name]",value:r,className:"condition-new-group-name",placeholder:n["new-group-name"],style:{width:"100%",display:f?"block":"none"},onChange:function(e){return i(e.target.value)},onBlur:function(){r.length?g(r,c):(p(!1),i(""),l(""))}}))};var D=function(e,n){if(!n)return e;var t=function(e){void 0===e&&(e=[]);var n=function(n){if(e.length)return e.findIndex((function(e){return e.id===n}))};return{addConditional:function(t){var o=n(t.id);return(void 0===o||0>o)&&(e=[].concat(e,[t]),!0)},removeConditional:function(t){var o=n(t);return!(void 0===o||0>o)&&(e=[].concat(e.slice(0,o),e.slice(o+1)),!0)},updateConditional:function(t){var o=n(t.id);return!(void 0===o||0>o)&&(e=[].concat(e.slice(0,o),[t],e.slice(o+1)),!0)},getConditional:function(t){var o=n(t);if(!(void 0===o||0>o))return e[o]},getAllConditionals:function(){return e}}}(e);switch(n.type){case"ADD_CONDITIONAL":t.addConditional(n.conditional);break;case"REMOVE_CONDITIONAL":t.removeConditional(n.conditionalId);break;case"UPDATE_CONDITIONAL":t.updateConditional(Object.assign({},n.conditional));break;default:return e}return[].concat(t.getAllConditionals())};function j(e){var n=[];return e.config&&e.config.groups&&e.config.groups.forEach((function(e){e.lines.forEach((function(e){n.push(e.field)}))})),n}var _=function(e){var n,t=e.formFields,o=e.strings,r=e.onChange,i=e.groupId,a=(0,function(e){return{getNotAllowedFields:function(){return j(e.conditional)}}}({conditional:e.conditional}).getNotAllowedFields)(),c=null===(n=e.conditional.config)||void 0===n?void 0:n.appliesTo;function l(e){return void 0!==c&&c.includes(e)}return s.a.createElement("div",{style:{float:"left",width:"288px",paddingLeft:"12px"}},s.a.createElement("h4",{style:{borderBottom:"1px solid rgb(191, 191, 191)",margin:"0px 0px 6px; padding: 0px 0px 6px"}},o["applied-fields"]),s.a.createElement("p",{className:"description"},o["select-apply-fields"]),t.map((function(e){var n,t=(n=e.ID,void 0!==a&&a.includes(n)),o={disabled:t,value:i,style:{marginLeft:"-20px"},type:"checkbox",className:"caldera-conditional-applies-field "+e.ID};return t?o.checked=!1:(o.onClick=function(){c&&c.length?l(e.ID)?r([].concat(c.filter((function(n){return e.ID!==n})))):r([].concat(c,[e.ID])):r([e.ID])},o.checked=l(e.ID)),s.a.createElement("label",{key:e.ID,style:{display:"block",marginLeft:"20px"}},s.a.createElement("input",Object.assign({},o)),e.label)})))},A=function(e){var n={field:[],system:[]};if(e.hasOwnProperty("field")&&e.field.hasOwnProperty("tags")){var t=e.field.wrap[0],o=e.field.wrap[1];Object.keys(e.field.tags).forEach((function(r){e.field.tags[r].forEach((function(e){n.field.push({tag:e,type:r,before:t,after:o})}))}))}if(e.hasOwnProperty("system")&&e.system.hasOwnProperty("tags")){var r=e.system.wrap[0],i=e.system.wrap[1];Object.keys(e.system.tags).forEach((function(t){e.system.tags[t].forEach((function(e){n.system.push({tag:e,type:t,before:r,after:i})}))}))}return n},T=window.system_values?window.system_values:{},S={tags:A(T)},R=s.a.createContext(),M=function(e){var n=s.a.useState((function(){var n=e.systemValues?{tags:A(e.systemValues)}:S;return e.fieldMagicTags&&(n.tags.field=e.fieldMagicTags),n})),t=n[0],o=n[1];return s.a.createElement(R.Provider,{value:O({},t,{getFieldTags:function(){var n={};return e.fieldMagicTags?e.fieldMagicTags.forEach((function(e){n[e.tag]=e})):t.tags.field.forEach((function(e){n[e.tag]=e})),Object.values(n)},getSystemTags:function(){var e={};return t.tags.system.forEach((function(n){e[n.tag]=n})),Object.values(e)},addTag:function(e,n,r){var i,a={tag:e,before:"system"===r?"{":"%",after:"system"===r?"}":"%",type:n};o(O({},t,{tags:O({},t.tags,(i={},i[r]=[].concat(t.tags.field,[a]),i))}))},removeTag:function(e,n){var r,i=[];switch(n){case"system":i=t.tags.system;break;case"field":default:i=t.tags.field}var a=[];i.forEach((function(n){n.tag!=e&&a.push(n)})),o(O({},t,{tags:O({},t.tags,(r={},r[n]=a,r))}))}})},e.children)},L=function(e){var n=""+e.tag.before+e.tag.tag+e.tag.after;return s.a.createElement("li",{className:"tag",onClick:function(){return e.onClick(n)}},n)},B=function(e,n,t){return e.filter((function(e){var o=n.replace(t,"");return e.tag.includes(n)||(""+t+e.tag).includes(o)}))};function U(e){var n=s.a.useMemo((function(){return e.tagMatch?B(e.field,e.tagMatch,"%"):e.field}),[e.field]),t=s.a.useMemo((function(){return e.tagMatch?B(e.system,e.tagMatch,"{"):e.system}),[e.system]);return s.a.createElement("ul",null,n.length?s.a.createElement(s.a.Fragment,null,s.a.createElement("li",{className:"header",key:"header-fields"},"Fields"),n.map((function(n){return s.a.createElement(L,{tag:n,key:n.tag,onClick:e.onClick})}))):null,t.length?s.a.createElement(s.a.Fragment,null,s.a.createElement("li",{className:"header",key:"header-system"},"System"),t.map((function(n){return s.a.createElement(L,{tag:n,key:n.tag,onClick:e.onClick})}))):null)}var G=function(e){return["dropdown","checkbox","radio","filtered_select2","toggle_switch"].includes(e)},V=function(e){var n=s.a.useRef(),t=e.value,o=e.formFields,r=e.fieldConfig,i=e.onChangeValue,a=e.fieldId,c=s.a.useState(!1),l=c[0],u=c[1],d=function(){window.setTimeout((function(){u(!1)}),250)},f=s.a.useContext(R),p=f.getFieldTags,m=f.getSystemTags;return s.a.createElement("span",{className:"caldera-conditional-field-value",style:{padding:"0 12px 0",display:"inline-block",width:"200px"}},G(r.type)?s.a.createElement("select",{value:t,onChange:function(e){return i(e.target.value)},style:{maxWidth:"165px",verticalAlign:"inherit"}},s.a.createElement("option",{key:1}),function(e,n){var t=[],o=n.find((function(n){return n.ID===e}));return o&&o.config&&o.config.option&&(t=Object.keys(o.config.option).map((function(e){var n,t=null==o||null===(n=o.config)||void 0===n?void 0:n.option[e],r={id:e,value:e,label:e};return t?O({},r,{label:t.label}):r}))),t}(a,o).map((function(e){return s.a.createElement("option",{key:e.id,value:e.value},e.label)}))):s.a.createElement(s.a.Fragment,null,s.a.createElement("input",{ref:function(e){return n.current=e},onChange:function(e){return i(e.target.value)},value:t,type:"text",onFocus:function(){u(!0)},onBlur:d,className:"caldera-conditional-field-value-input"}),l&&s.a.createElement("span",{className:"magic-tags-list"},s.a.createElement(U,{tagMatch:t,onClick:function(e){i(e),d()},field:p(),system:m()}))))},q=function(e){var n=e.line,t=e.strings,o=e.isFirst,r=e.onRemoveLine,i=e.onUpdateLine,a=n.value,c=n.field,l=n.compare,u=n.id,d=F(e.formFields),f=d.formFields,p=d.getFieldById,m=s.a.useMemo((function(){var e=p(n.field);return e||(e={type:"text",ID:"",slug:"",label:""}),e}),[n,f]);return s.a.createElement("div",{key:u,className:"caldera-condition-line condition-line-"+u},s.a.createElement("span",{style:{display:"inline-block"}},o?s.a.createElement(s.a.Fragment,null,t.if):s.a.createElement(s.a.Fragment,null,t.and)),s.a.createElement("select",{style:{maxWidth:"120px",verticalAlign:"inherit"},className:"condition-line-field",value:c,onChange:function(e){return function(e){m&&G(m.type)!==G(p(e).type)&&(n.value=""),i(O({},n,{field:e}))}(e.target.value)}},s.a.createElement("option",{key:2}),s.a.createElement("optgroup",{label:t.fields,key:3},f.map((function(n){return s.a.createElement("option",{value:n.ID,disabled:e.appliesToFields&&e.appliesToFields.includes(n.ID)},n.label," [",n.slug,"]")})))),s.a.createElement("select",{className:"condition-line-compare",value:l,onChange:function(e){return function(e){i(O({},n,{compare:e}))}(e.target.value)},style:{maxWidth:"120px",verticalAlign:"inherit"}},s.a.createElement("option",{key:0}),["is","isnot","greater","smaller","startswith","endswith","contains"].map((function(e){return s.a.createElement("option",{key:e,value:e},e)}))),s.a.createElement(V,{value:a,formFields:f,fieldId:c,onChangeValue:function(e){i(O({},n,{value:e}))},fieldConfig:m}),s.a.createElement("button",{onClick:function(e){e.preventDefault(),r(u,n.parent?n.parent:"")},className:"button pull-right condition-line-remove",type:"button"},s.a.createElement("i",{className:"icon-join"})))},Q=function(e){var n=e.lines,t=e.strings,o=e.formFields,r=e.onRemoveLine,i=e.onUpdateLine,a=e.onAddLine,c=e.groupId,l=e.appliesToFields;return s.a.createElement("div",{className:"caldera-condition-group caldera-condition-lines"},n.map((function(e,n){return s.a.createElement(s.a.Fragment,{key:e.id},s.a.createElement(q,{line:e,isFirst:0===n,onUpdateLine:function(n){return i(n,e.id)},strings:t,formFields:o,onRemoveLine:function(){return r(e.id,e.parent?e.parent:c)},appliesToFields:l||[]}))})),s.a.createElement("div",{style:{margin:"12px 0 0"},key:10},s.a.createElement("button",{className:"button button-small condition-group-add-line",type:"button",onClick:function(e){e.preventDefault(),a(c)}},t["add-condition"])))},W=function(e){return s.a.createElement("button",{type:"button",className:e.className?e.className:"pull-right button button-small condition-group-add-lines",onClick:function(n){n.preventDefault(),e.onAddGroup()}},e.strings["add-conditional-group"])},H=function(){return"rw_"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,12)},z=function(){return"cl_"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,12)},K=function(e){var n,t=e.conditional,o=e.formFields,r=e.strings,i=e.onRemoveConditional,a=e.onUpdateConditional,c=t.type,l=t.config,d=t.id,f=l&&l.hasOwnProperty("group")?l.group:{},p=t.hasOwnProperty("config")&&(null===(n=t.config)||void 0===n?void 0:n.hasOwnProperty("name"))?t.config.name:"",m=s.a.useMemo((function(){return Object.keys(f)}),[f]),g=s.a.useMemo((function(){return Array.isArray(m)&&m.length>=1?m[m.length-1]:""}),[f]);return s.a.createElement("div",{className:"caldera-editor-condition-config caldera-forms-condition-edit",style:{width:"auto"}},s.a.createElement("div",{className:"condition-point-"+d,style:{float:"left",width:"550px"}},s.a.createElement("div",{className:"caldera-config-group"},s.a.createElement("label",{htmlFor:"condition-group-name-"+d},r.name),s.a.createElement("div",{className:"caldera-config-field"},s.a.createElement("input",{type:"text",name:"conditions["+d+"][name]",id:"condition-group-name-"+d,value:p,onChange:function(e){return function(e){var n;a(O({},t,{config:O({},t.config,{name:e,appliesTo:(null===(n=t.config)||void 0===n?void 0:n.appliesTo)||[]})}))}(e.target.value)},required:!0,className:"required block-input condition-group-name"}))),t.config&&s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"caldera-config-group"},s.a.createElement("label",{htmlFor:"condition-group-type-"+d},r.type),s.a.createElement("div",{className:"caldera-config-field"},s.a.createElement("select",{value:c,onChange:function(e){return function(e){return a(O({},t,{type:e}))}(e.target.value)},id:"condition-group-type-"+d,name:"conditions["+d+"][type]",className:"condition-group-type"},s.a.createElement("option",{value:"",key:0}),s.a.createElement("option",{value:"show",key:"show"},r.show),s.a.createElement("option",{value:"hide",key:"hide"},r.hide),s.a.createElement("option",{value:"disable",key:"disabled"},r.disable)),c&&s.a.createElement(W,{strings:r,onAddGroup:function(){var e,n,o,r=H(),i=z();a({id:d,type:c,config:O({},t.config,{group:O({},null===(e=t.config)||void 0===e?void 0:e.group,(o={},o[r]=(n={},n[i]={id:i,field:"",value:"",compare:"is",parent:r},n),o))})})}}))),m.map((function(e){var n,i=f?f[e]:void 0;if(!i)return s.a.createElement(u.Fragment,null);var l=Object.keys(i).map((function(e){return O({},i[e],{id:e})}));return s.a.createElement(u.Fragment,null,s.a.createElement(Q,{lines:l,appliesToFields:null===(n=t.config)||void 0===n?void 0:n.appliesTo,strings:r,formFields:o,onUpdateLine:function(n,o){return function(e,n,o){var r,i,c,l,u=t.config.group;u=O({},u,((i={})[o]=O({},u[o],((r={})[n]=e,r)),i));var s=[],d=(null===(c=t.config)||void 0===c?void 0:c.appliesTo)||[];s=N(u);var f={};s.map((function(e){e.lines.forEach((function(e){if(f[e.id]=e.field,d.includes(e.field))if(1>=d.length)d=[];else{var n=d.findIndex((function(n){return n===e.field}));d=[].concat(d.splice(0,n),d.splice(n+1))}}))})),a({id:t.id,type:t.type,config:{name:(null===(l=t.config)||void 0===l?void 0:l.name)||"",appliesTo:d,group:u,fields:f,groups:s}})}(n,o,e)},onRemoveLine:function(n){return function(e,n){var o=f;delete o[n][e],Object.values(o[n]).length||delete o[n],a(O({},t,{config:O({},t.config,{group:o})}))}(n,e)},onAddLine:function(){return function(e){var n,o,r,i=z();a({id:d,type:c,config:O({},t.config,{group:O({},null===(n=t.config)||void 0===n?void 0:n.group,(r={},r[e]=O({},t.config.group[e],(o={},o[i]={field:"",value:"",compare:"is",parent:e},o)),r))})})}(e)},groupId:e}),g!==e&&s.a.createElement("span",{className:"caldera-conditonals-or",style:{display:"block",margin:"0px 0px 8px"}},r.hasOwnProperty("or")?r.or:"or"))})),s.a.createElement("button",{style:{margin:"12px 0 12px"},type:"button",className:"block-input button condition-remove","data-confirm":r["confirm-remove"],onClick:function(e){e.preventDefault(),window.confirm(r["remove-condfirm"])&&i(d)}},r["remove-condition"]),s.a.createElement(_,{formFields:o,strings:r,groupId:t.id,conditional:t,onChange:function(e){a(O({},t,{config:O({},t.config,{appliesTo:e})}))}}))))},Y=s.a.createContext({}),J=function(e){var n=function(e){var n=s.a.useReducer(D,e.conditionals),t=n[0],o=n[1],r=function(e){var n=t.length?t.findIndex((function(n){return n.id===e})):void 0;if(!(void 0===n||0>n))return t[n]};return{conditionals:t,getConditional:r,getConditionals:function(){return t},getAppliedFields:function(){var e={};return t.forEach((function(n){var t;(null===(t=n.config)||void 0===t?void 0:t.appliesTo)&&n.config.appliesTo.forEach((function(t){e[t]=n.id}))})),e},getNotAllowedFields:function(e){var n=r(e);return n&&n.config&&n.config.groups?j(n):[]},addConditional:function(e){o({type:"ADD_CONDITIONAL",conditional:e})},updateConditional:function(e){o({type:"UPDATE_CONDITIONAL",conditional:e})},removeConditional:function(e){o({type:"REMOVE_CONDITIONAL",conditionalId:e})}}}({conditionals:e.initialConditionals}),t=n.conditionals,o=n.updateConditional,r=n.removeConditional,i=n.getConditional,a=n.getNotAllowedFields,c=n.addConditional,l=n.getConditionals,u=n.getAppliedFields;return s.a.createElement(Y.Provider,{value:{conditionals:t,hasConditionals:function(){return t.length>0},updateConditional:o,removeConditional:r,getConditional:i,getNotAllowedFields:a,addConditional:c,getConditionals:l,getAppliedFields:u}},e.children)},Z=function(e){var n=e.formFields,t=e.strings,o=s.a.useState(null),r=o[0],i=o[1],a=s.a.useContext(Y),c=a.conditionals,l=a.updateConditional,d=a.removeConditional,f=a.getConditional,p=a.getNotAllowedFields,m=a.addConditional,g=r?f(r):void 0;return s.a.createElement(u.Fragment,null,s.a.createElement("div",{className:"caldera-editor-conditions-panel",style:{marginBottom:"32px"}},c&&c.length?s.a.createElement("ul",{className:"active-conditions-list"},c.map((function(e){var n,t=r===e.id;return s.a.createElement("li",{key:e.id,className:"caldera-condition-nav "+(t?"active":"")+" caldera-forms-condition-group condition-point-"+e.id},s.a.createElement("a",{id:"condition-open-group-"+e.id,className:"condition-open-group",onClick:function(n){n.preventDefault(),i(e.id)},style:{cursor:"pointer"}},s.a.createElement("span",{id:"condition-group-"+e.id},null===(n=e.config)||void 0===n?void 0:n.name),s.a.createElement("span",{className:"condition-line-number"})))}))):s.a.createElement("ul",{className:"active-conditions-list"}),s.a.createElement(x,{strings:t,onNewConditional:function(e,n){m({id:n,type:"show",config:{name:e,appliesTo:[]}}),i(n)}})),g&&s.a.createElement(K,{conditional:g,formFields:n,strings:t,onRemoveConditional:function(e){d(e)},onUpdateConditional:function(e){l(e)},notAllowedFields:p(r)}))};function $(e){var n=s.a.useState((function(){return O({},e.conditional,{type:e.conditional.type?e.conditional.type:"use"})})),t=n[0],o=n[1],r=function(n){var t=v()(n);o(t),e.onUpdate&&e.onUpdate(t)},i=function(e,n){return e.lines.findIndex((function(e){return n==e.id}))},a=function(e){var n;return null===(n=t.groups)||void 0===n?void 0:n.findIndex((function(n){return n.id===e.id}))},c=function(e){e=Object.assign({},e),t.groups||r(O({},t,{groups:[e]}));var n=a(e);r(O({},t,void 0===typeof n||-1>=n?{groups:[e]}:{groups:[].concat(t.groups.slice(0,n),[e],t.groups.slice(n+1))}))},l=function(e){var n;return null===(n=t.groups)||void 0===n?void 0:n.find((function(n){return e===n.id}))};return{conditional:t,onChangeType:function(e){r(O({},t,{type:e}))},onAddGroup:function(e){var n=t.groups?t.groups:[];n.push(e),r(O({},t,{groups:n}))},onRemoveLine:function(e,n){var o=l(n);if(o)if(1===o.lines.length)!function(e){var n,o=a(e);1===(null===(n=t.groups)||void 0===n?void 0:n.length)?r(O({},t,{groups:[]})):void 0!==typeof o&&0<=o&&r(O({},t,{groups:[].concat(t.groups.slice(0,o),t.groups.slice(o+1))}))}(o);else{var u=i(o,e);u&&0<=u&&c(O({},o,{lines:[].concat(o.lines.slice(0,u),o.lines.slice(u+1))}))}},onUpdateLine:function(e,n,t){var o=l(n);if(o){var r=i(o,t);-1<r&&(o.lines[r]=e,c(o))}},onAddLine:function(e){var n=l(e);if(n){var t={value:"",field:"string",compare:"is",id:z(),parent:e};n.lines.push(t),c(n)}},getGroup:l,getLine:function(e,n){var t=l(e);if(t)return function(e,n){return e.lines.find((function(e){return n==e.id}))}(t,n)}}}var X=function(e){var n=e.processorId,t=e.onChange,o=e.value;return s.a.createElement("select",{onChange:function(e){return t(e.target.value)},value:o||"",className:"caldera-conditionals-usetype",id:"caldera-conditionals-usetype-"+n},s.a.createElement("option",{key:0}),[{value:"use",label:"Use"},{value:"not",label:"Do Not Use"}].map((function(e){return s.a.createElement("option",{key:e.value,value:e.value},e.label)})))};function ee(e){var n=e.conditional,t=e.strings,o=n.type;return s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement(X,{value:o,onChange:function(n){e.onChangeType(n)},processorId:e.processorId}),s.a.createElement(W,{strings:t,onAddGroup:function(){var n=H();e.onAddGroup({id:n,lines:[{field:"",value:"",compare:"is",parent:n,id:z()}]})},className:"pull-right button button-small add-conditional-group"})),""!==o&&n.groups&&n.groups.map((function(n){return s.a.createElement(Q,{formFields:e.formFields,lines:n.lines,strings:e.strings,onRemoveLine:function(t){e.onRemoveLine(t,n.id)},onUpdateLine:function(t,o){e.onUpdateLine(t,n.id,o)},onAddLine:function(){e.onAddLine(n.id)},groupId:e.processorId})})))}var ne={if:"If",and:"And",name:"Name",disable:"Disable",type:"Type","add-conditional-group":"Add Conditional Line","applied-fields":"Applied Fields","select-apply-fields":"Select the fields to apply this condition to.","remove-condition":"Remove Conditon","remove-condfirm":"Are you sure you would like to remove this conditional group?",show:"Show",hide:"Hide","new-conditional":"New Conditon",fields:"Fields"};function te(e,n){var t,o,r;if(!n)return O({},e);switch(n.type){case"ADD_PROCESSOR":var i=n.processorId?n.processorId:"p_"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,12);return O({},e,((t={})[i]={id:i,runtimes:{insert:1},type:n.processorType,conditionals:{type:""}},t));case"REMOVE_PROCESSOR":var a=Object.assign({},e);return delete a[n.processorId],a;case"UPDATE_PROCESSOR":return O({},e,((o={})[n.processor.id]=n.processor,o));case"UPDATE_PROCESSOR_CONDITIONS":var c=n.processorId,l=n.conditionals,u=O({},e[c],{conditionals:l});return O({},e,((r={})[c]=u,r))}}var oe=function(e){var n=e.children,t=e.domNode;return t?h.a.createPortal(n,t):null},re=function(e,n){return n.length?n.findIndex((function(n){return e===n.ID})):-1},ie=function(e,n){var t=re(n.ID,e);return t>=0?[].concat(e.slice(0,t),[Object.assign({},n)],e.slice(t+1)):e};function ae(e,n){if(!n)return[].concat(e);switch(n.type){case"ADD_FIELD":return-1===re(n.field.ID,e)?[].concat(e,[n.field]):e;case"UPDATE_FIELD":return ie(e,n.field);case"UPDATE_FIELDS":return n.fields.forEach((function(n){e=ie(e,n)})),e;case"REMOVE_FIELD":var t=n.fieldId,o=re(t,e);return o>=0?[].concat(e.slice(0,o),e.slice(o+1)):e;case"CHANGE_CONDITIONAL_GROUP":var r=re(n.fieldId,e);if(-1<r){var i=e[r];return i.conditions={type:n.conditionalId},ie(e,i)}return e;case"FIELD_CONFIG_CHANGE":return function(e,n,t){var o=e.split("[").map((function(e){return e.replace("]","")})),r=!1,i="",a="",c=!1;o.forEach((function(e,n){if(!["config","fields"].includes(e))if(!1===r)i=o[n],a=o[n+1],r=!0;else{var t=o.findIndex((function(e){return e===a}));if(e===a&&t+1===o.length)return void(c=!0)}}));var l,u=t.find((function(e){return i===e.ID}));if(!u)return t;if(c)return ie(t,O({},u,((l={})[a]=n,l)));if(o.includes("option")){var s,d,f,p;(null===(s=u.config)||void 0===s?void 0:s.hasOwnProperty("option"))||(u.config.option={});var m=null===(d=u.config)||void 0===d?void 0:d.option,g=o[o.length-2];m&&!m.hasOwnProperty(g)&&(m[g]={label:""}),m=O({},m,((p={})[g]=O({},m[g],((f={})[o[o.length-1]]=n,f)),p)),u=O({},u,{config:O({},u.config,{option:m})})}else{var v,y=((v={})[o.pop()]=n,v);u=O({},u,{config:O({},u.config,{},y)})}return u?ie(t,u):t}(n.name,n.value,e);default:return e}}var ce=s.a.createContext({}),le=function(e){var n=s.a.useReducer(ae,e.intitalFields?Object.keys(e.intitalFields).map((function(n){return O({ID:n},e.intitalFields[n])})):[]),t=n[0],o=n[1],r=F(t).getFieldById;return s.a.createElement(ce.Provider,{value:{formFields:t,updateFields:function(e){o(function(e){return{type:"UPDATE_FIELDS",fields:e}}(e))},getFieldById:r,updateFieldConditonal:function(e,n){o(function(e,n){return{type:"CHANGE_CONDITIONAL_GROUP",fieldId:e,conditionalId:n}}(e,n))},updateFieldSetting:function(e,n){o(function(e,n){return{type:"FIELD_CONFIG_CHANGE",name:e,value:n}}(e,n))},addField:function(e){var n={ID:e.ID,label:e.label,slug:e.slug,value:"",type:"",conditions:{type:""},config:{}};o(function(e){return{type:"ADD_FIELD",field:e}}(n))},removeField:function(e){o(function(e){return{type:"REMOVE_FIELD",fieldId:e}}(e))},updateFieldType:function(e,n){o({type:"UPDATE_FIELD",field:O({},r(e),{type:n})})}}},e.children)},ue=function(e){var n=s.a.useMemo((function(){return[{value:"",label:""}].concat(e.conditionalGroups)}),[e.conditionalGroups]);return s.a.createElement(I,{isStandard:!0,onChange:e.onChange,value:e.value?e.value:"",className:"caldera-conditionals-usetype block-input",label:e.label?e.label:"Condition",options:n,id:"field-condition-type-"+e.fieldId,settingName:"config[fields]["+e.fieldId+"][conditions][type]"})};function se(e){var n,t=s.a.useContext(Y),o=t.getConditionals,r=t.getConditional,i=t.conditionals,a=t.updateConditional,c=s.a.useContext(ce),l=c.getFieldById,u=c.formFields,d=c.updateFieldConditonal,f=null===(n=s.a.useMemo((function(){return l(e.fieldId)}),[e.fieldId,u]).conditions)||void 0===n?void 0:n.type,p=s.a.useMemo((function(){return o().map((function(e){var n;return{value:e.id,label:e.config?null===(n=e.config)||void 0===n?void 0:n.name:e.id}}))}),[e.fieldId,i]);return s.a.createElement(ue,{conditionalGroups:p,label:e.label,fieldId:e.fieldId,value:f,onChange:function(n){d(e.fieldId,n);var t,o=r(f);(o&&(o.config||(o.config={name:"",appliesTo:[]}),a(O({},o,{config:O({},o.config,{appliesTo:o.config.appliesTo.filter((function(n){return n!==e.fieldId}))})}))),n)&&((o=r(n))&&(o.config||(o.config={name:"",appliesTo:[]}),a(O({},o,{config:O({},o.config,{appliesTo:[].concat(null===(t=o.config)||void 0===t?void 0:t.appliesTo,[e.fieldId])})}))))}})}var de=s.a.createContext(null),fe=function(e){var n=s.a.useState(""),t=n[0],o=n[1],r=function(e){var n=s.a.useReducer(te,e.processors),t=n[0],o=n[1];return{processors:t,addProcessor:function(e,n){return o({type:"ADD_PROCESSOR",processorType:e,processorId:n})},updateProcessor:function(e){return o({type:"UPDATE_PROCESSOR",processor:e})},removeProcessor:function(e){return o({type:"REMOVE_PROCESSOR",processorId:e})},updateProcessorConditionals:function(e,n){o({type:"UPDATE_PROCESSOR_CONDITIONS",processorId:e,conditionals:n})},getProcessor:function(e){return t.hasOwnProperty(e)?t[e]:void 0}}}({processors:e.initialProcessors}),i=r.getProcessor,a=r.updateProcessor,c=r.processors,l=r.addProcessor,u=r.removeProcessor;return s.a.createElement(de.Provider,{value:{hasProcessors:function(){return Object.keys(c).length>0},getProcessor:i,updateProcessor:a,processors:c,activeProcessorId:t,setActiveProcessorId:o,removeProcessor:u,addProcessor:l}},e.children)},pe=function(e,n){console.log(e),console.log(n)},me=function(e){var n=s.a.useContext(ce).formFields,t=s.a.useContext(de).activeProcessorId,o=document.getElementById(t+"_conditions_pane");return o?s.a.createElement(oe,{domNode:o},s.a.createElement(b.a,{onError:pe},s.a.createElement(Ee,{strings:e.strings?e.strings:ye,formFields:n}))):s.a.createElement(s.a.Fragment,null)},ge=function(e){var n=e.conditionalsNode,t=s.a.useContext(ce),o=t.formFields,r=t.updateFieldConditonal,i=s.a.useContext(Y),a=i.conditionals,c=i.getAppliedFields;return s.a.useEffect((function(){var e=c();o.forEach((function(n){e.hasOwnProperty(n.ID)?r(n.ID,e[n.ID]):r(n.ID,"")}))}),[a]),s.a.createElement(s.a.Fragment,null,s.a.createElement(me,{strings:e.strings}),s.a.createElement(oe,{domNode:n},s.a.createElement(b.a,{onError:pe},s.a.createElement(Z,{formFields:o,strings:e.strings?e.strings:ye}))),e.children)};function ve(e){var n=e.savedForm.fields?e.savedForm.fields:{},t=[];e.savedForm.hasOwnProperty("conditional_groups")&&e.savedForm.conditional_groups.hasOwnProperty("conditions")&&(t=w(e.savedForm.conditional_groups.conditions,e.savedForm.fields));var o=be(e.savedForm.processors?e.savedForm.processors:{});return s.a.createElement(s.a.Fragment,null,s.a.createElement(le,{intitalFields:n},s.a.createElement(M,{systemValues:e.systemValues},s.a.createElement(J,{initialConditionals:t},s.a.createElement(fe,{initialProcessors:o},s.a.createElement(ge,{strings:e.strings,conditionalsNode:e.conditionalsNode,jQuery:e.jQuery},e.children))))))}var ye=O({},ne);function he(e){var n=e.processor,t=$({conditional:n.conditionals,onUpdate:function(t){e.onChange(O({},n,{conditionals:t}))}}),o=t.conditional,r=t.onAddLine,i=t.onRemoveLine,a=t.onUpdateLine,c=t.onChangeType,l=t.onAddGroup;return s.a.createElement("div",{className:"processor-"+n.id+" caldera-forms-processor-conditions-edit"},s.a.createElement(ee,Object.assign({strings:e.strings,formFields:e.formFields,processorId:n.id},{onAddGroup:l,conditional:o,onAddLine:r,onRemoveLine:i,onUpdateLine:a,onChangeType:c})))}function Ee(e){var n=e.formFields,t=e.strings,o=s.a.useContext(de),r=o.getProcessor,i=o.updateProcessor,a=s.a.useContext(de).activeProcessorId,c=a?r(a):void 0;return s.a.createElement(s.a.Fragment,null,c&&s.a.createElement(he,{processor:c,formFields:n,strings:t,onChange:i}))}var be=function(e){var n={};return Object.keys(e).forEach((function(t){var o,r,i=e[t],a={id:i.ID,type:i.type,conditionals:{type:"",groups:[]}};i.hasOwnProperty("runtimes")&&(a.runtimes=i.runtimes),i.hasOwnProperty("config")&&(a.config=i.config),i.hasOwnProperty("conditions")&&(i.conditions.hasOwnProperty("type")||(i.conditions.type=""),i.conditions.hasOwnProperty("group")||(i.conditions.group={}),a.conditionals=(o=i.conditions,r=[],o.hasOwnProperty("group")&&o.group&&Object.keys(o.group).forEach((function(e){var n=[];Object.keys(o.group[e]).forEach((function(t){n.push(O({},o.group[e][t],{id:t}))})),r.push({id:e,lines:n})})),{type:o.type,groups:r})),n[t]=a})),n},Oe=function(e,n){var t=function(e,n){n=n||{};var t={};return Object.keys(e).forEach((function(o){var r,i=e[o],a={type:"",group:{}};i.hasOwnProperty("conditionals")&&(a.type=i.conditionals.type,null===(r=i.conditionals.groups)||void 0===r||r.map((function(e){var n=e.id;e.lines.forEach((function(e){var t;a.group[n]=O({},a.group[n],((t={})[e.id]={value:e.value,field:e.field,compare:e.compare},t))}))})));var c=n.hasOwnProperty(i.id)?n[i.id]:void 0,l=c&&c.config?c.config:{};t[i.id]=O({},c,{ID:i.id,type:i.type?i.type:"use",conditions:a,runtimes:i.runtimes?i.runtimes:{insert:0},config:l})})),t}(e,n),o=Object.entries(n).map((function(e){var n=a()(e,1)[0];return[n,t[n]]}));return Object.fromEntries(o)};function Ce(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function Ie(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Ce(Object(t),!0).forEach((function(n){r()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ce(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Fe=function(){var e=s.a.useContext(ce).formFields,n=s.a.useContext(Y).conditionals;return s.a.useMemo((function(){return Object(c.createElement)(s.a.Fragment,null,e&&e.length?e.map((function(e){var n,t=(n=e.ID,document.getElementById("field-condition-type-".concat(n)));return t?Object(c.createElement)(s.a.Fragment,{key:e.ID},Object(c.createElement)(oe,{domNode:t},Object(c.createElement)(se,{fieldId:e.ID}))):Object(c.createElement)(s.a.Fragment,{key:e.ID})})):Object(c.createElement)(s.a.Fragment,null))}),[e,n])},we=function(e){var n=e.jQuery,t=e.formId;void 0===t&&(t=CF_ADMIN.form.ID);var o=s.a.useContext(Y),r=o.conditionals,i=o.hasConditionals,u=s.a.useContext(de).processors,d=s.a.useState(!1),f=a()(d,2),p=f[0],g=f[1];return Object(c.createElement)(l.Button,{isPrimary:!0,isBusy:p,className:"button button-primary caldera-header-save-button",type:"button",onClick:function(){if(g(!0),!check_required_bindings())return g(!1),!1;void 0!==window.tinyMCE&&window.tinyMCE.triggerSave();var e=n(".caldera-forms-options-form").formJSON();if(n(document).trigger("cf.presave",{config:e.config}),e.config.conditional_groups=i?{conditions:e.conditions=P(r)}:{},e.config.processors){var o={};Object.keys(u).forEach((function(n){e.config.processors.hasOwnProperty(n)&&(o[n]=u[n])})),e.config.processors=Oe(o,e.config.processors)}else e.config.processors={};r.length>0&&(e.config.hasOwnProperty("fields")&&Object.keys(e.config.fields).forEach((function(n){e.config.fields.hasOwnProperty(n)&&(e.config.fields[n].conditions={type:""})})),r.forEach((function(n){var t=n.hasOwnProperty("config")?n.config.appliesTo:[];t&&t.forEach((function(t){e.config.fields.hasOwnProperty(t)&&(e.config.fields[t].conditions={type:n.id})}))}))),m()({path:"/cf-api/v2/forms/".concat(t),data:Ie({},e),method:"PUT"}).then((function(e){e.form_id,e.form;var t=n(".updated_notice_box");t.stop().animate({top:0},200,(function(){setTimeout((function(){t.stop().animate({top:-75},700)}),1700)}))})).catch((function(e){return console.log(e)})).finally((function(){window.setTimeout((function(){g(!1)}),2e3)}))}},p?"Saving":"Save Form")},Pe=function(e){var n=e.jQuery,t=s.a.useContext(ce),o=t.getFieldById,r=t.updateFieldSetting,i=t.addField,a=t.removeField,l=t.updateFieldType;return s.a.useEffect((function(){var e=!0;return n(document).on("field.config-change",(function(n,t){var o=t.name,i=t.value;e&&r(o,i)})),n(document).on("field.removed",(function(n,t){e&&a(t.fieldId)})),n(document).on("field.added",(function(n,t){if(e){var o={ID:t.field.id,label:t.field.label,slug:t.field.slug,value:"",type:"",conditions:{type:""},config:{}};i(o)}})),n(".caldera-editor-body").on("change",".caldera-select-field-type",(function(){if(e){var t=n(this),o=t.attr("data-field");l(o,t.val())}})),function(){e=!1}}),[n,o]),Object(c.createElement)(s.a.Fragment,null)},Ne=function(e){var n=e.jQuery,t=s.a.useContext(de),o=t.updateProcessor,r=t.getProcessor,i=t.setActiveProcessorId,a=t.addProcessor;return s.a.useEffect((function(){var e=!0;return n(document).on("processor.added",(function(t,o){e&&(i(o.processor.id),n(".caldera-processor-nav a").on("click",(function(){i(n(this).parent().data("pid"))})))})),n(document).on("processor.added",(function(e,n){a(n.processor.type,n.processor.id)})),n(".caldera-processor-nav a").on("click",(function(){i(n(this).parent().data("pid"))})),n(document).on("processor.enabled",(function(e,n){o(Ie(Ie({},r(n.processorId)),{},{runtimes:{insert:1}}))})),n(document).on("processor.disabled",(function(e,n){o(Ie(Ie({},r(n.processorId)),{},{runtimes:{insert:0}}))})),function(){e=!1}}),[n]),Object(c.createElement)(s.a.Fragment,null)},ke=function(e){var n=e.savedForm,t=e.jQuery,o=e.conditionalsNode;return Object(c.createElement)(ve,{strings:CF_FORM_BUILDER.strings,savedForm:n,jQuery:t,conditionalsNode:o},Object(c.createElement)(Pe,{jQuery:t}),Object(c.createElement)(Ne,{jQuery:t}),Object(c.createElement)(Fe,null),Object(c.createElement)(oe,{domNode:document.getElementById("caldera-header-save-button")},Object(c.createElement)(we,{jQuery:t})))};f()((function(){var e=CF_ADMIN.form;e.hasOwnProperty("fields")||(e.fields={});var n=document.getElementById("caldera-forms-conditions-panel");Object(c.render)(Object(c.createElement)(ke,{savedForm:e,conditionalsNode:n,jQuery:window.jQuery}),document.getElementById("caldera-forms-form-builder"))}))}]);